#!/usr/bin/env bash

# This script audits DNS records for specified subdomains of a given domain.

# Check if the correct number of arguments is provided.
if [ $# -lt 1 ] || [ $# -gt 2 ]; then
    echo "Usage: $0 domain [subdomain]"
    exit 1
fi

# Set domain and subdomain variables based on user input.
domain="$1"
subdomain="$2"

# Define a function to query DNS records.
query_dns() {
    domain="$1"
    subdomain="$2"
    dig_output=$(dig +short "$subdomain.$domain")
    if [ -n "$dig_output" ]; then
        echo "The subdomain $subdomain is a A record and points to $dig_output"
    else
        echo "The subdomain $subdomain does not have a valid A record"
    fi
}

# If no subdomain is specified, query records for default subdomains.
if [ -z "$subdomain" ]; then
    subdomains=("www" "lb-01" "web-01" "web-02")
    for sub in "${subdomains[@]}"; do
        query_dns "$domain" "$sub"
    done
else
    # If a subdomain is specified, query records for that subdomain.
    query_dns "$domain" "$subdomain"
fi
