#!/usr/bin/env bash

# Function to fetch DNS information for a subdomain
get_dns_info() {
    subdomain="$1"
    domain="$2"
    dns_output=$(dig ${subdomain}.${domain} | awk '/^;; ANSWER SECTION:/{getline; print}')
    if [[ -n "${dns_output}" ]]; then
        echo "The subdomain ${subdomain} is a $(echo ${dns_output} | awk '{print $4}') record and points to $(echo ${dns_output} | awk '{print $5}')"
    else
        echo "No DNS information found for ${subdomain}.${domain}"
    fi
}

# Main function
main() {
    domain="$1"
    subdomain="$2"

    if [[ -z "${subdomain}" ]]; then
        # If only domain is provided, check default subdomains
        subdomains=("www" "lb-01" "web-01" "web-02")
        for sub in "${subdomains[@]}"; do
            get_dns_info "${sub}" "${domain}"
        done
    else
        # If both domain and subdomain are provided, check the specified subdomain
        get_dns_info "${subdomain}" "${domain}"
    fi
}

# Check for correct number of arguments
if [[ "$#" -lt 1 || "$#" -gt 2 ]]; then
    echo "Usage: $0 <domain> [subdomain]"
    exit 1
fi

# Call the main function with provided arguments
main "$1" "$2"
