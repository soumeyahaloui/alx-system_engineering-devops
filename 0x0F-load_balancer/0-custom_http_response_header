#!/usr/bin/env bash
# This script configures Nginx to add a custom HTTP response header on a new Ubuntu machine.

# Install Nginx if it's not already installed
if ! command -v nginx &>/dev/null; then
  sudo apt-get update
  sudo apt-get install -y nginx
fi

# Configure Nginx to add the custom HTTP response header
custom_header_config="add_header X-Served-By \$hostname;"

# Check if the custom header configuration already exists in the Nginx default site config
if ! grep -q "$custom_header_config" /etc/nginx/sites-available/default; then
  # Add the custom header configuration to the default site config
  echo "$custom_header_config" | sudo tee -a /etc/nginx/sites-available/default
fi

# Reload Nginx to apply the changes
sudo systemctl reload nginx

# Exit with success status
exit 0
